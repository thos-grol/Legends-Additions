//figure out persistent tile effects for entities?
//skill that checks on move??

::MSU.Log.printData( this.m.BaseProperties, 2);
::MSU.Log.printData( scripts );

//FEATURE_1: vampire overhaul and infected contracts
    //FEATURE_1: FEATURE Necrosavant -> Grail, Knock | necrosavant -> dead apostle
    //Modes:
        //Scummy - tp away close to party, summon weakest bro to it
        //Guerilla - tp and strike, tp and strike
        //Vampire - Casts blood magic, charms enemies
    //All attacks cause bleed, and heal damage caused from attacks including bleed.
    //Hexe

//TODO: fix sounds so loud


//TODO: rework skeleton units
//TODO: rework skeleton priest //drops miasma tome

//FEATURE_0: create machine learning model for art


//FIXME: SCAVENGE witcher mod for inspirations
//FIXME: SCAVENGE get ciri teleport
//FIXME: SCAVENGE get aard

//////////////////////////////////////////////

Theoretical Framework for Dungeon

- Dungons consists of stages
    - each stage has a deck of encounters - random events or fights
        - boss discovered (enables option to fight boss in screen)
        - X amount of treasure cards - 10%, treasure deck
        - encounter deck - 80%
        - event deck - 10%

        example screen:
        Area description
        Treasures found X/X

        Choices
            - Explore (Will draw from deck after rolling for which deck)
            - Challenge Boss (Hidden until unlocked)
            - Go Deeper (Hidden until boss defeated)
            - Leave

Spawn 1 castle of night per playthrough

First Dungeon:

Castle of Night
This area is shrouded by eteranl night. In front of you looms a tangle of trees, a dense dark wood no doubt the scene where many have lost their lives. In the distance looms a majestic castle....'

The Woods
There seems to be some strange magic in these woods. Though you can see the castle in the distance, the distance in the woods does not shrink.

Treasure Deck:

3 Named Items

1 Artefact
- Rueful Axe, found in the forest
    A cursed axe with a cursed story
    drawn by hatred - enemies will be massively drawn to kill this character

        the price is paid in blood - select a random brother in your party. if you take that axe, that brother will die
        otherwise you lose the chance to take the axe forever

- Chain of Anguish
    Chain that inflicts anguish on those it strikes, decreasing their ap and has a high armor piercing
    Negative side effect is that the bearer has a chance of taking part of the damage they inflict (luck can influence this chace) and that each strike has a chance of creating a ghost to seek revenge from the weilder


- Sword of Decay

- Cursed Handgonne, used by the gatekeeper
    - every third shot fired will definitely hit the shooter
    - unequipping the weapon will die

Boss: The Fool
- black jester helm - drop as loot, false. ending event will reward the hat
    - nihil - transform greed, hate, despair, and wrath traits into more powerful versions
        "Did you make me, or did I make you?"
        - greed (greedy)
            Happiness became obsession, obsession became greed...
            - every time an enemy is hit, roll (can be influenced by luck)
                - if this character is higher, recover 5-10 HP
                - else lose 5-10 HP
        - hate (any hate trait)
            love turned into hatred...
            - upon missing an attack, become staggered
            - upon missing 3 attacks, reduce the AP cost of attacks by 1 (max 2)
        - despair (deathwish)
            when vows turned awry and the heart became hollow, all that was left was despair...
            - every time this character is hit, gain 10% damage reduction (up to 50%)
            - on turn start if this character was hit, X% chance to lose 5 AP. X is the % damage reduction
        - wrath (bloodthirsty)
            - betrayal was the seed of wrath...
            - gain x% damage
            - on turn start, attack a random character. if there are no allied characters within attack range of this character, there will be a rising chance to attack themselves

        if all 4 traits are found on this character, the traits lose their negative effects.
        all characters around this character are afflicted with nihil

     - unequipping will die


---

Event Deck:
    Fool


bloodthirsty units
    gain +20% stats
    gain lacerate
    gain bloodbath - buff bloodbath to increase initiative and damage

Encounter deck:
    Feral Wolf
    Bloodthirsty Wolf
    Bloodthirsty Peasant
    Bloodthirsty Thug
    Bloodthirsty Raider

Boss: The Gatekeeper

spawn legendary location on start
suppression quests otherwise, the castle will conduct raids, and more bloodthirsty will spawn

The Castle of Night
    Treasure: blood magic book
        - convert health to mana
        - bats teleport
        - blood needles - fires needles of blood that infect the target and causes bleed
            - blood harvest - all bleeding units within 3 tiles will take 5 damage. Will heal the caster 2 for each enemy damaged this way
        - blood explosion - detonate the infected blood, causing damage for each infection stack. if the enemy dies, inflict blood needle to all units in 2 tile radius


Encounter deck:
    Bloodthirsty Servant (has necrosavant powers) stage I
    Bloodthirsty Guard (has necrosavant powers) stage II
    Blood Noble (has necrosavant powers) stage III

Final Boss: Dead Apostle (true necrosavant) stage IV
    Dead apostle potion


'


//////////////////////////////////////////////

//reworked perk trees, ideas:
	//stone shard
		https://stoneshard.fandom.com/wiki/Pyromancy_(skill_tree)
		https://stoneshard.fandom.com/wiki/Geomancy_(skill_tree)
	//dead cells.
		//https://deadcells.fandom.com/wiki/Gear#Skills
		//interesting weapon design
	//pokemon
		//for magic passives
			//Magic Guard
			//Intimidate
			//Protean - Used for magic
			//Poison Heal
		//status effects
			//sleep
			//paralysis
			//burn
			//poison/toxic
			//frozen
			//panic
		.
	//Dungeon crawl stone soup
		http://crawl.chaosforge.org/List_of_spells_by_school
		http://crawl.chaosforge.org/Brand
		http://crawl.chaosforge.org/Ego
		http://crawl.chaosforge.org/List_of_unrands
		http://crawl.chaosforge.org/God
		http://crawl.chaosforge.org/Unique_monster

	//LW2
		//Bladestorm
		//Free sword attacks on any enemies that enter or attack from melee range.

		Combatives
		You may parry melee attacks and counterattack with your combat knife. Also gain +10 dodge.

		Cutthroat
		Your melee attacks against biological enemies ignore their armor, have a +15 critical chance, and do +2 critical damage.

		Deadeye
		Take a shot with a small aim penalty for a significant damage boost.

		Cloaking
		Cloaking resets sneak attack targets

		Lightning Reflexes
		Reaction fire shots against you have a significantly decreased chance to hit. The bonus goes down with each additional reaction shot you face
			+50 mdef until you wait or end turn
			function onTurnEnd()
			function onWaitTurn()


		Mark Target
		Locked On
		Gain +10 aim and +10 crit for successive shots at the same enemy unit.

		Domination (Grail)
		Permanently mind control an enemy. Only one successful Domination can be performed per mission.

		Fortress (Pokemon Magic Gaurd)
		The Psi Operative is immune to fire, poison, acid, and explosive damage.

		Stasis (Winter)
		Completely stuns the target for 1 turn, but renders them immune to any damage or attack.


//Magic has a cast chance - then a hit chance.

//Ideas
	//Luck - increases the chances of effects occuring. Bad luck decreases it.

	//Fragile - takes more injuries
	//Open Wounds - increases the damage of applied bleed.
	//Stagger
	//Slower

	//Bleeding
	//Poison

	//Daze
	//Stun

//FEATURE_8: Redback Spider -> Lantern (Fate, Wisdom) - Glassfinger toxin
//FEATURE_8: Lindwurm -> Dragon -> Dream, Edge (Poison)
//FEATURE_8: Schrat -> Heart, Lantern



//Z

//Fantasy Bros Skills worth looking into
    //Pyromancer
        2 skills are good
    //Shaman
        magical healing skill
        miracle
    //Fight Master
        Crushing Blow
        Storm fury
    //Enchantress
        Blessing Fx Only
        Hymn of Valor Fx only
    //Wizard
        Frost Blast
            Ground is buggy, use necro's tile changing code instead
        Thunder Bolt
    //Warlock
        Acid grenade fx
        Hellfire grenade ground fire
    //Umbra
        Banshee scream skill targeting? Geist???

    //Arcane missile



//Faction Overhaul
    //every settlement spawns guards, guards vary in strength
    //update action
        faction action <- factions have a chance to build strength during update
            combine multiple contract checks into update action,
            contract expiring can raise bandit faction strength
            contract completion can raise settlement strength/security
            settlements store monster strength, create witcher necrophages?

    //military action <- suppress menace

    //function buildSettlements( _rect )

    //Predefine noble house
        //function createNobleHouses( _num )
        //function assignSettlementsToNobleHouses( _nobleHouses )
            //upon assigning settlement to noble house, you can edit the buildings and attached locations?

    //Building camps only occur when faction strength reaches threshold to expand
    //Factions with no camps remain dormant until later
    //Contracts are only generated when faction strength reaches a certain ammount

    //timed out contracts: contractmanager, function update( _force = false ), c.isTimedOut()

//FEATURE_8: dungeon, source of money when no contracts
    rooms:
        treasure room
        trap room
        monster room
        boss room
    dungeon consists of generated rooms stored with loot.
    dungeon exploration progress. when it reaches 100% boss room.

    dungeon:
        Endless Woods
        Black Monolith
        Library

//FEATURE_8: one village is slated for death upon geneartion. At a certain day in the campaign, generate ghosts. event can trigger at night where you are stuck. if you survive, then you hear ghost stories about how village was burned mysteriously years ago and no one dares to live there. Ghost boss.
//if disguise is torn off, it becomes a dungeon.
//remove weakest 20% of bros. Rest have a chance to be cursed by ghost and haunted. Haunting can even kill party members if they fail the check. Reveal starts when you take a contract to defend the village from raiders or hexe or alps and you stay overnight...

//FEATURE_8: arena,source of money when no contracts



//New Long Term Contracts:
    //Dungeon exploration
    //Opening up the wilderness
    //Arena

Book Items
    Put book in bag slot. While camping, bro can learn book.

Apothecary
Alchemist/Potion Master Rework
    Potions in bag slots. Potions become ranged ammo. Potion master perk lets you switch ammo to throw them.
    Perk, chance to not consume ammo when throwing potion.
Anatomist can be potion master

BOSS
Hexe Leader with Lindwurm Pet
    Hex ties 2 brothers together, 3 turn duration
    Illusionary root on all hexed enemies

Items
    Storm star : A magic morning star that could release a version of chain lightning when it hit.
    Lefeber's Enchanter : A rod that imbued items with the ability to store spells.

Schools:

    Winter - Silence and death. The dead. The end.
    Heart - Unrelenting optimism. The beating of the heart keeps the world running. Preservation. Continuation. Thunder.
    Grail - Desire and birth. The feast. The color red. Gluttony. Vampires.
    Moth - Desire to change. Transformation.
    Lantern - The light of knowledge with no mercy. Certainty and uncertainy. Fate and luck. Divination.
    Forge - Shaping and fire. Runelore.
    Edge - The secrets of the blade and battle.

    Dream - [O]utside the ordered universe [is] that amorphous blight of nethermost confusion which blasphemes and bubbles at the center of all infinityâ€”the boundless daemon sultan Azathoth, whose name no lips dare speak aloud, and who gnaws hungrily in inconceivable, unlighted chambers beyond time and space amidst the muffled, maddening beating of vile drums and the thin monotonous whine of accursed flutes.

    The dream is the origin of all mysteries, and the end of all mysteries. And herein lies it's secret doctrine.

    Theoretical:

        Defense:
            Magic Shield
                perk: autocast magic shield before taking damage
        Utility:
            Blood Magic - Convert your health to mana, 4 AP

    Elements:
        Air
            Offensive:
                Shock
                Wind Blade - Cutting attack that bleeds, hits 2 characters adjacent to the target
                Lightning bolt - 100% chance to hit, can only be resisted
                Chain Lightning - 100% chance to hit, can only be resisted
            Defensive:
                Gust - Knock enemy back, giving them baffled and that effect that makes moving harder
                    perk: autocast gust before taking damage
                    perk: gust stuns
            Utility:
                Haste

        Earth - Defense, Single Target Damage
            Vile Clutch
            Iron Shot
            Crystal Spear
        Fire - Aoe Damage, DAMAGE, burn
            Combustion +20 to hit
            Fireball
            Flame Thrower +20 to hit
            Sticky Flame
            Flamestrike +30 to hit
        Ice - Control
            Ice Spear
            Frost Nova
            Simulacrum




    Hexes
        Illusion
        Charm
    Holy
        Resurrection
    Eldritch

    Prophecy (Vala):


            //Unique Spells - Can take from hero's autobiography
            Create Death Knight - Chooses a corpse on the floor to be a death knight. You can only have 1 death knight at a time
            Negative Energy Fireball -
            Drain Life - Draws health from the target to caster
                ::Const.Perks.PerkDefs.LegendSiphon



---


Undead cannot be charmed


-----

::setSpawn("scripts/entity/tactical/enemies/bandit_leader", ::Const.Faction.Enemy)
::setSpawn("orc_warlord", ::Const.Faction.PlayerAnimals)
::setSpawn("legend_orc_behemoth")

::setSpawn("hexe", ::Const.Faction.PlayerAnimals)
::setSpawn("hexe")
::setSpawn("bandit_raider", ::Const.Faction.PlayerAnimals)
::setSpawn("swordmaster", ::Const.Faction.PlayerAnimals)
::setSpawn("swordmaster", ::Const.Faction.PlayerAnimals)

::setSpawn("legend_peasant_blacksmith", ::Const.Faction.PlayerAnimals)
::setSpawn("ghost_knight", ::Const.Faction.PlayerAnimals)
::setSpawn("bandit_leader", ::Const.Faction.PlayerAnimals)
::setSpawn("nomad_leader", ::Const.Faction.PlayerAnimals)

::setSpawn("barbarian_madman", ::Const.Faction.PlayerAnimals)

::setSpawn("bandit_raider")

::setSpawn("ghost", ::Const.Faction.PlayerAnimals)
::setSpawn("desert_devil", ::Const.Faction.PlayerAnimals)
::setSpawn("bandit_veteran", ::Const.Faction.PlayerAnimals)
::setSpawn("zombie_knight", ::Const.Faction.PlayerAnimals)
::setSpawn("zombie_knight", ::Const.Faction.PlayerAnimals)
::setSpawn("goblin_wolfrider", ::Const.Faction.PlayerAnimals)
::setSpawn("cultist_priest", ::Const.Faction.PlayerAnimals)
::setSpawn("spider", ::Const.Faction.PlayerAnimals)
::setSpawn("necromancer")
::setSpawn("zombie_knight")
::setSpawn("spider", ::Const.Faction.Enemy)


::addItem("tome")
::addItem("mage_winter_potion_item")

::addItem("legend_robes_magic")
::addItem("soul_splinter")
::addItem("goblin_overseer_potion_item")
::addItem("direwolf_potion_item")
::addItem("fallen_hero_potion_item")
::addItem("crude_axe")

::addItem("orc_young_potion_item")


bbrusher pack legends_additions.brush C:\Files\Projects\bbros\brush\legends_additions --gfxPath C:\Files\Projects\bbros\brush



