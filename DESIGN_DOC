DEFENDER has been knocked back
DEFENDER has been lacerated.

Economy Overhaul

//TODO: LOG: Rabble is breaking.

//TODO: this.m.Payment.Pool, contracts

//TODO: disable most ambitions, rework
    //Slay a monster -> unlock anatomist retinue
        //Anatomist retinue unlocks anatomist events.

//TODO: fix alchemist having named items.
//TODO: Reintegrate mood changes.
//TODO: integrate logic World economy.



Caravans now take goods out of each building's inventory of the town they leave, carry the goods in their inventory, and deliver the goods into the inventory of the town they arrive at. Paying the origin town when they unload.
Patrols, Mercenaries, Ships, Peasants and caravans are more frequent to increase the odds of caravans making it through and towns serving and thriving.

patch:
- escort_caravan_contract.nut
- world_state.nut

//New potion system

//FEATURE_5: Fantasy Bros Investigation


//FEATURE_0: create new monsters to replace old ones and ensure compat. Make monster spawns much rarer.
    //Direwolf
        //The more attacks it recieves, the higher it's fury...


    //Webknecht
    //Direwolf
    //Necrosavant
    //Schrat
        //Atributes: Heart, Lantern
        //Weakness: Fire
        //Abilities:
            //Passive:
                //Crown of flies: Attacking enemies have a chance to be inflicted with flies.
                //Uproot: wood attack striking 3 tiles long. Rooting them.
                //Uproot (Circle): wood attack striking everything around it, knocking them back, rooting them.
                //Barkskin: Recovers a shield every few turns. Resistance to arrows and bolts. Weak to fire.

    //Lindwurm

//FEATURE_1: Camping and Retinue and class Rework
camping ui
    //FEATURE_1: replace crafting tent on screen with anatomist, hide if you don't have
    //FEATURE_1: replace tent on screen with alchemist, hide if you don't have
    //FEATURE_1: comment out tents that can be accessed from main tent
    //FEATURE_1: remove crafting and training from main tent

    //FEATURE_1: change money added from contracts and events
    //FEATURE_1: cart can only be upgraded once, experiment with stash size
    //this.World.Assets.addMoney
    //FEATURE_1: remove most events that give free stuff, you need traits etc to earn them
    //FEATURE_1: remove most class perks from trees
    //FEATURE_1: make some backgrounds have garunteed stats/traits, ie. lumberjacks will come with passive for axes



//FEATURE_5: Faction Overhaul
    //every settlement spawns guards, guards vary in strength
    //update action
        faction action <- factions have a chance to build strength during update
            combine multiple contract checks into update action,
            contract expiring can raise bandit faction strength
            contract completion can raise settlement strength/security
            settlements store monster strength, create witcher necrophages?

    //military action <- suppress menace

    //function buildSettlements( _rect )

    //Predefine noble house
        //function createNobleHouses( _num )
        //function assignSettlementsToNobleHouses( _nobleHouses )
            //upon assigning settlement to noble house, you can edit the buildings and attached locations?

    //Building camps only occur when faction strength reaches threshold to expand
    //Factions with no camps remain dormant until later
    //Contracts are only generated when faction strength reaches a certain ammount

    //timed out contracts: contractmanager, function update( _force = false ), c.isTimedOut()

//FEATURE_9: dungeon, source of money when no contracts
    rooms:
        treasure room
        trap room
        monster room
        boss room
    dungeon consists of generated rooms stored with loot.
    dungeon exploration progress. when it reaches 100% boss room.

    dungeon:
        Endless Woods
        Black Monolith
        Library

//FEATURE_9: one village is slated for death upon geneartion. At a certain day in the campaign, generate ghosts. event can trigger at night where you are stuck. if you survive, then you hear ghost stories about how village was burned mysteriously years ago and no one dares to live there. Ghost boss.
//if disguise is torn off, it becomes a dungeon.
//remove weakest 20% of bros. Rest have a chance to be cursed by ghost and haunted. Haunting can even kill party members if they fail the check. Reveal starts when you take a contract to defend the village from raiders or hexe or alps and you stay overnight...

//FEATURE_9: arena,source of money when no contracts



//New Long Term Contracts:
    //Dungeon exploration
    //Opening up the wilderness
    //Arena

//FEATURE_2: contract, ambition, event pay, money rework
    //FEATURE_2: script to generate all ambitions
    //FEATURE_2: script to generate all contracts
    //FEATURE_2: disable donkey events
    //FEATURE_2: disable oathtaker armor event
    //FEATURE_2: start making the world poorer, troop equipment nerf
    //FEATURE_2: most mobs besides top tier mobs will be using at most chain armor
    //FEATURE_2: you'll find old hedge knights with good armor in noble armies, new hedge knights will now have weaker armor. Buff battleforged?

//FEATURE_6: sellswords armor rework? - no perks needed, buffs granted based on armor weight
//FEATURE_6: muscularity for bows and slings
//FEATURE_6: bow perk that has a chance to make shot have 99% AP based on range skill
//FEATURE_6: fletching etc costs money to do <- the resources have to come from somwhere don't they?
//FEATURE_9: elite bro joins for high hiring cost event <- young swordmaster event <- when reknown is high enough


FEATURE_9: Origins to Revamp:
    - Beast Slayers
    - Scaling Beggar
    - Old Swordmaster
    - Davkul Cultists
    - Gladiators
    - Lone Wolf
    - Peasant Militia

Book Items
    Put book in bag slot. While camping, bro can learn book.

Apothecary
Alchemist/Potion Master Rework
    Potions in bag slots. Potions become ranged ammo. Potion master perk lets you switch ammo to throw them.
    Perk, chance to not consume ammo when throwing potion.
Anatomist can be potion master

Overhaul Cultists
    - Permenant Injuries. For every permenant injury, give a unique buff.

BOSS
Hexe Leader with Lindwurm Pet
    Hex ties 2 brothers together, 3 turn duration
    Illusionary root on all hexed enemies

Items
    Storm star : A magic morning star that could release a version of chain lightning when it hit.
    Lefeber's Enchanter : A rod that imbued items with the ability to store spells.

Magic
    Mana stat
    Resolve = Will
    Ranged Attack = Aim
    Inteligence Trait
        Smart Trait - Above average intelligence
        Bright Trait - Highly Intelligent
        Genius Trait - Super Intelligent

    magic modifiers:
        learn time <- higher intelligence has a bigger chance to learn spells

        magic matrix <- determines what school of spells you can cast and learn
        cast speed <- higher intelligence can decrease cast time

        mana <- the pool you cast spells from

        will <- used in checks/conflicts. can determine success rate of spell
            summoning ghosts/binding them to your will

        the more perks you take in the school, the more knowledge you have. knowledge = power.
            power die + spell roll die = effect damage

Schools:
    Origin - The tides of magic have waned. This world is undergoing the end of the dharma... where fantasy is wasting away. The only miracles left are the remnants of the gods, inner or outer... The mainstream power of this world is blasphemy... using the remains of the gods to achieve power.

    Winter - Silence and death. The dead. The end.
    Heart - Unrelenting optimism. The beating of the heart keeps the world running. Preservation. Continuation. Thunder.
    Grail - Desire and birth. The feast. The color red. Gluttony. Vampires.
    Moth - Desire to change. Transformation.
    Lantern - The light of knowledge with no mercy. Certainty and uncertainy. Fate and luck. Divination.
    Forge - Shaping and fire. Runelore.
    Edge - The secrets of the blade and battle.

    Dream - [O]utside the ordered universe [is] that amorphous blight of nethermost confusion which blasphemes and bubbles at the center of all infinityâ€”the boundless daemon sultan Azathoth, whose name no lips dare speak aloud, and who gnaws hungrily in inconceivable, unlighted chambers beyond time and space amidst the muffled, maddening beating of vile drums and the thin monotonous whine of accursed flutes.

    The dream is the origin of all mysteries, and the end of all mysteries. And herein lies it's secret doctrine.

    Theoretical:

        Defense:
            Magic Shield
                perk: autocast magic shield before taking damage
        Utility:
            Blood Magic - Convert your health to mana, 4 AP

    Elements:
        Air
            Offensive:
                Shock
                Wind Blade - Cutting attack that bleeds, hits 2 characters adjacent to the target
                Lightning bolt - 100% chance to hit, can only be resisted
                Chain Lightning - 100% chance to hit, can only be resisted
            Defensive:
                Gust - Knock enemy back, giving them baffled and that effect that makes moving harder
                    perk: autocast gust before taking damage
                    perk: gust stuns
            Utility:
                Haste

        Earth - Defense, Single Target Damage
            Vile Clutch
            Iron Shot
            Crystal Spear
        Fire - Aoe Damage, DAMAGE, burn
            Combustion +20 to hit
            Fireball
            Flame Thrower +20 to hit
            Sticky Flame
            Flamestrike +30 to hit
        Ice - Control
            Ice Spear
            Frost Nova
            Simulacrum




    Hexes
        Illusion
        Charm
    Holy
        Resurrection
    Eldritch

    Prophecy (Vala):


            //Unique Spells - Can take from hero's autobiography
            Create Death Knight - Chooses a corpse on the floor to be a death knight. You can only have 1 death knight at a time
            Negative Energy Fireball -
            Drain Life - Draws health from the target to caster
                ::Const.Perks.PerkDefs.LegendSiphon



---

Potions

All potions increase life stat and then a secondary stat.

Ghoul
    - Tier 1 HP (15, 30)
    - Tier 3 Initiative (20, 40)

Direwolf
    - Tier 3 AP (2, 4)
    - Fatigue (15, 30)
    - Fatigue Regeneration (5, 10)


Alp
    - Tier 2 Resolve (15, 30)

Orc
    - Tier 2 Hp (15, 30)
    - Tier 2 Fat (20, 40)

Unhold
    - Tier 3 Hp (20, 40)

Wurm
    - Tier 3 Hp (20, 40)


schrat

serpent

vampire




Poison (No Stat)
 - Spider

Goblin potion doesnt increase life - have it do something else.

---

book_item
    fields:
        traits
        spells, contained

Magic Matrix - Engrave a magic matrix allowing you to learn spells of a certain school
Meditation -

Necronomicon

camp:
    no action = learn from spellbook

Champion variants of heroes

Undead cannot be charmed


-----

::setSpawn("scripts/entity/tactical/enemies/bandit_leader", ::Const.Faction.Enemy)
::setSpawn("nomad_leader", ::Const.Faction.PlayerAnimals)

::setSpawn("nomad_outlaw", ::Const.Faction.PlayerAnimals)
::setSpawn("bandit_raider", ::Const.Faction.PlayerAnimals)
::setSpawn("swordmaster", ::Const.Faction.PlayerAnimals)
::setSpawn("swordmaster", ::Const.Faction.PlayerAnimals)

::setSpawn("legend_peasant_blacksmith", ::Const.Faction.PlayerAnimals)
::setSpawn("ghost_knight", ::Const.Faction.PlayerAnimals)
::setSpawn("bandit_leader", ::Const.Faction.PlayerAnimals)
::setSpawn("bandit_leader", ::Const.Faction.PlayerAnimals)
::setSpawn("bandit_leader")
::setSpawn("spider", ::Const.Faction.Enemy)


::addItem("bone_figurines")

::addItem("legend_robes_wizard")
::addItem("apotheosis_potion_item")
::addItem("goblin_overseer_potion_item")
::addItem("nachzehrer_potion_item")
::addItem("fallen_hero_potion_item")
::addItem("two_handed_wooden_flail")

::addItem("orc_young_potion_item")
::addItem("orc_warlord_potion_item")
::addItem("daze_bomb_item")
::addItem("fighting_axe")
::addItem("shamshir")
::addItem("scimitar")
::addItem("legend_helmet_sack")
::addItem("legend_helmet_cloth_scarf")
::addItem("hunting_bow")
::addItem("legend_staff_gnarled")

::addItem("named_handgonne")
::addItem("war_bow")
::addItem("heater_shield")
::addItem("strange_eye_item")
::addItem()


bbrusher pack legends_additions.brush C:\Files\Projects\bbros\brush\legends_additions --gfxPath C:\Files\Projects\bbros\brush